<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PDA String Checker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .step {
            border-left: 4px solid #3b82f6;
            padding-left: 16px;
            margin-bottom: 10px;
        }

        .step-heading {
            font-weight: bold;
            color: #3b82f6;
        }

        .step-content {
            padding-left: 20px;
            font-size: 16px;
        }

        .collapsible {
            background-color: #f3f4f6;
            border: none;
            text-align: left;
            padding: 10px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .active,
        .collapsible:hover {
            background-color: #d1d5db;
        }

        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f9fafb;
        }

        .result-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-wrapper .ai-result {
            max-width: 80%;
            overflow-wrap: break-word;
        }

        .bold-text {
            font-weight: bold;
            color: #1d4ed8;
        }

        .error-text {
            color: #ef4444;
            font-weight: bold;
        }

        .success-text {
            color: #10b981;
            font-weight: bold;
        }

        .result-section {
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 16px;
            border-radius: 8px;
            background-color: #f9fafb;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .answer-section {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
            background-color: #f9fafb;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center">

    <div class="bg-white shadow-lg rounded-lg p-8 max-w-lg w-full">
        <h1 class="text-3xl font-bold text-center text-blue-700 mb-6">Pushdown Automata Checker (AI-Powered)</h1>

        <form id="pdaForm" class="flex flex-col gap-4">
            <textarea id="pdaDescription" class="border rounded-md p-3 h-32"
                placeholder="Enter PDA description (states, alphabet, stack alphabet, transitions, start, accept states)"
                required></textarea>
            <input id="inputString" type="text" class="border rounded-md p-3" placeholder="Enter input string..."
                required />
            <button id="submitButton" type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-md">Check String</button>
        </form>

        <div id="aiResult" class="mt-6 text-gray-700 text-lg"></div>
        <div id="result" class="mt-6 text-center text-2xl font-semibold"></div>

    </div>

    <script>
        const form = document.getElementById('pdaForm');
        const aiResultDiv = document.getElementById('aiResult');
        const resultDiv = document.getElementById('result');

        form.addEventListener('submit', async function (event) {
            event.preventDefault();

            const pdaDescription = document.getElementById('pdaDescription').value.trim();
            const inputString = document.getElementById('inputString').value.trim();
            const submitButton = document.getElementById("submitButton");

            submitButton.innerHTML = "Checking...";

            const aiExplanation = await getGeminiResponse(pdaDescription, inputString);

            aiResultDiv.innerHTML = `</div><div class="answer-section">
                <div class="step"><span class="step-heading">Result:</span><div class="step-content">${aiExplanation}</div></div>`
            submitButton.innerHTML = "Check String";
        });

        async function getGeminiResponse(description, inputString) {
            try {
                const response = await fetch('http://localhost:3001/check', {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ pdaDescription: description, inputString })
                });

                const data = await response.json();
                return data.explanation || "No AI response.";
            } catch (error) {
                console.error(error);
                return "Error contacting server.";
            }
        }

    </script>

    <script>

        var coll = document.getElementsByClassName("collapsible");
        for (var i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }
    </script>

</body>

</html>